## 接口设计

### 🧩 页面一：登录界面（/login）

**功能描述：** 用户输入邮箱和密码进行登录，后端验证账号密码后返回 token 和用户信息。

**需要调用的 API：**

1. **用户登录**
   1. 方法：`POST`
   2. 路径：`/api/users/login`
   3. 请求参数：用户输入的邮箱与密码
   4. 使用说明：前端登录成功后保存 token 和角色信息到 localStorage，并跳转到主页面。
2. **获取当前用户信息（可选，用于刷新页面时再次确认身份）**
   1. 方法：`GET`
   2. 路径：`/api/users/me`
   3. 请求头：`Authorization: Bearer <token>`
   4. 使用说明：页面加载时判断用户是否已登录，并获取身份信息。

### 🧩 页面二：注册界面（/register）

**功能描述：** 新用户输入邮箱、密码、学号等进行注册，后端保存账号并发送激活邮件。

**需要调用的 API：**

1. **用户注册**
   1. 方法：`POST`
   2. 路径：`/api/users/register`
   3. 使用说明：注册成功后提示用户去邮箱激活账号。
2. **邮箱验证（可能自动处理）**
   1. 方法：`GET`
   2. 路径：`/api/users/verify?token=xxx`
   3. 说明：用户点击邮箱中的链接后，后端激活账户。

### 🧩 页面三：找回密码界面（/forgot-password）

**功能描述：** 用户忘记密码时，可以通过邮箱请求重置密码链接，点击邮件中的链接后设置新密码。

（感觉这部分有点麻烦了，可以直接）

**需要调用的 API：**

1. **发送找回密码邮件**
   1. 方法：`POST`
   2. 路径：`/api/users/send-email`
   3. 使用说明：用户输入邮箱后，后端发送包含重置链接的邮件。
2. **重置密码**（点击邮箱链接进入的页面）
   1. 方法：`POST`
   2. 路径：`/api/users/reset-password`
   3. 使用说明：用户通过邮箱链接进入页面后，输入新密码完成密码重置。

### 🧩 页面四：用户个人主页（/profile）

**功能描述：** 用户查看和编辑自己的个人信息，包括用户名、头像、密码等设置。为了简洁，所有操作集中在一个页面，不再单独拆分“设置”页。在这里需要鉴定执行这些操作的请求是不是来自用户本身，可以通过session来鉴定。

**需要调用的 API：**

1. **获取当前用户信息**
   1. 方法：`GET`
   2. 路径：`/api/users/me`
   3. 请求头：`Authorization: Bearer <token>`
2. **修改用户名**
   1. 方法：`POST`
   2. 路径：`/api/users/``username`
3. **修改密码**
   1. 方法：`POST`
   2. 路径：`/api/users/reset-password`
4. **上传头像**
   1. 方法：`POST`
   2. 路径：`/api/users/avatar`
5. **注销账户**
   1. 方法：`POST`
   2. 路径：`/api/users/delete`
   3. 请求头：`Authorization: Bearer <token>`

### 🧩 页面五：我的预定页面（/my-bookings）

**功能描述：** 展示当前用户所有的会议室预定记录，按时间排序（最近的在前）。显示进行中的预定与历史预定，并提供取消或修改操作入口。管理员不会看到此页面。

**需要调用的 API：**

1. **获取当前用户的预定记录**
   1. 方法：`GET`
   2. 路径：`/api/bookings/my`
   3. 请求头：`Authorization: Bearer <token>`
2. **取消预定 （需要通过不同的请求方式来区分吗，感觉还是不同的api会更方便一点）**
   1. 方法：`GET`
   2. 路径：`/api/bookings/cancel/{bookingId}`
3. **修改预定时间，地点**
   1. 方法：`POST`
   2. 路径：`/api/bookings/modify`
4. **每个预定记录都可以展示该会议参与的人员信息**
   1. 方法：`GET`
   2. 路径: `/api/bookings/involveUsers/{bookingId}`

### 🧩 页面六：会议室列表页面（/rooms）

**功能描述：** 显示系统中所有可用会议室的列表。用户和管理员都可以访问此页面，但权限不同：

- 普通用户只能查看、筛选、搜索、预定会议室
- 管理员可以额外进行编辑、删除、添加等操作

前端通过用户的 role 判断是否显示管理员部分的操作按钮。

**需要调用的 API：**

1. **获取会议室列表（支持筛选、排序、搜索）** **（这里需要专门设置两个 API 吗，根据可以直接根据请求的用户身份在后端校验）**
   1. 方法：`GET`
   2. 路径：`/api/rooms/roomlist`（身份在后端根据请求校验）
2. **查看会议室详情 （可以跳转到单独的页面 ）**
   1. 方法：`GET`
   2. 路径：`/api/rooms/{roomId}`（身份在后端根据请求校验）

### 🧩 页面七：管理员编辑会议室页面（/admin/rooms/edit）

**功能描述：** 管理员可以修改会议室的基本信息，包括房间号、容量、位置、IT 设施、可用时间和图片。

**需要调用的 API：**

1. **更新会议室基本信息（房间号、位置、容量、设施）**
   1. 方法：`POST`
   2. 路径：`/api/admin/rooms/edit`

### 🧩 页面八：管理员添加新会议室页面（/admin/rooms/add）

**功能描述：** 管理员可以添加一个新的会议室，填写基础信息（房间号、位置、容量、设施、图片、可用时间等）。

**需要调用的 API：**

1. **创建会议室基本信息**
   1. 方法：`POST`
   2. 路径：`/api/admin/rooms/add`

### 🧩 页面九：管理员用户管理页面（/admin/users）

**功能描述：** 管理员查看、搜索、筛选和管理所有用户的信息，包括预订记录、活动日志、账户状态等。支持锁定、解锁、删除用户以及添加新用户或管理员。

**需要调用的 API：**

1. **获取用户列表（支持筛选、排序、搜索）**
   1. 方法：`GET`
   2. 路径：`/api/admin/``users/userlist`
   3. 查询参数：（这里需要单独在后端创建一个请求类）
      - `keyword`: 模糊搜索邮箱或用户名
      - `sortBy`: 排序字段（如 `bookingCount`）
      - `order`: 排序方式（asc/desc）
      - `minBookings`: 筛选最少预定数
2. **查看单个用户详情** **（感觉还是有个单独的页面会简单一点，可以直接是 GET /users?userId={id}）**
   1. 方法：`GET`
   2. 路径：`/api/admin/users/{userId}`
3. **锁定用户账号**
   1. 方法：`GET`
   2. 路径：`/api/admin/users/lock/{userId}`
4. **解锁用户账号**
   1. 方法：`GET`
   2. 路径：`/api/admin/users/unloc/{userId}`
5. **删除用户账号**
   1. 方法：`GET`
   2. 路径：`/api/admin/users/delete/{userId}`
6. **添加新用户或管理员 (是否需要新的页面来写添加的用户信息，类似注册页面）**
   1. 方法：`POST`
   2. 路径：`/api/admin/users/add`

### 🧩 页面十：管理员审核会议预定页面（/admin/bookings-review）

**功能描述：** 管理员查看所有用户提交的预定申请，按时间排序，并可对申请进行审批（通过/拒绝），查看修改历史，以及用户信息。

**需要调用的 API：**

1. **获取所有预定申请列表（支持筛选和排序）**
   1. 方法：`GET`
   2. 路径：`/api/admin/bookings/bookinglist`
   3. 查询参数（可选）：
      - `status`: 筛选状态（如 `pending`, `approved`, `rejected`）
      - `sortBy`: 按申请时间、用户名排序
      - `order`: asc/desc
2. **查看单条预定详情（含修改历史）（是否需要新的页面）**
   1. 方法：`GET`
   2. 路径：`/api/admin/bookings/{bookingId}`
3. **批准预定申请**
   1. 方法：`POST`
   2. 路径：`/api/admin/bookings/approve/``{bookingId}`
4. **拒绝预定申请**
   1. 方法：`POST`
   2. 路径：`/api/admin/bookings/reject/``{bookingId}`

### 🧩 页面十一：用户反馈页面（/feedback）

1. **展示所有的反馈**
   1. 方法：`GET`
   2. 路径：`/api/feedback/all`
2. **发表反馈**
   1. 方法：`POST`
   2. 路径：`/api/feedback/add`



## 云服务器

The Aliyun server is available now, you can log in at: 

https://signin.aliyun.com/login.htm?callback=https%3A%2F%2Faccount.console.aliyun.com%2Fv2%2F#/main

with username;

[Group33@1553634882117581.onaliyun.com](https://ram.console.aliyun.com/users/detail?spm=5176.28366559.0.0.211e336aVvPlSf&userId=205436012390297457)

with password: Cpt202Group33

And access the ECS instance with user name: root

with password: Cpt202Group33